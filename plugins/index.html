<!DOCTYPE html>
<html lang="zh">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>今日油价</title>
  <style>
    html {
      font-size: 14px;
    }

    a {
      color: #5352ed;
      cursor: pointer;
    }

    .oil-table {
      width: 90%;
      font-size: 1.2rem;
      text-align: center;
      margin: auto;
      border-collapse: collapse;
      border: solid 1px #ccc;
    }

    .oil-table th {
      background-color: #5352ed;
      color: #fff;
      height: 40px;
    }

    .oil-table .tr {
      border: solid 1px #ccc;
      padding: 2px 0px;
      height: 30px;
    }

    i {
      color: #f94435;
      font-weight: bold;
      font-style: normal;
    }

    #title {
      text-align: center;
      margin: 8px;
      font-size: 1.2rem;
    }

    @media(prefers-color-scheme:light) {
      html {
        color: #2c3e50;
      }
    }

    @media(prefers-color-scheme:dark) {
      html {
        color: #adbac7;

      }

      .oil-table {
        border: solid 1px #3e4c5a;
      }

      .oil-table th {
        background-color: #5352ed;
        color: #ccc;
      }

      .oil-table .tr {
        border: solid 1px #3e4c5a;
      }

      a {
        color: #adbac7;
      }

      span {
        color: #f94435 !important;
        font-weight: bold;
      }
    }
  </style>
</head>

<body>
  <div id="title"></div>
  <div id="content"> </div>
  <div id="con-hide" style="display: none;"></div>
</body>

<script src="./js/jquery.min.js"></script>
<script>
  $(document).ready(function () {
    var xhr = new XMLHttpRequest()
    xhr.open('GET', 'http://www.qiyoujiage.com/', true)
    xhr.onreadystatechange = function () {
      if (xhr.readyState === 4 && xhr.status === 200) {
        var str = xhr.responseText.split('</ul>')[0] + "</ul>";
        str = "<ul" + str.split('<ul')[1];
        $('#con-hide').html(str);
        var tableHtml = "<table class='oil-table'>";
        tableHtml += '<thead><tr><th scope="col">地区</th><th scope="col">92号汽油</th><th scope="col">95号汽油</th><th scope="col">98号汽油</th><th scope="col">0号柴油</th></tr></thead>';
        var childrenLi = $('.ylist')[0].children;
        for (var i = 5; i < childrenLi.length; i++) {
          tableHtml += "<tr class='tr'><td><a onclick=\"selectProvince('" + childrenLi[i].innerText + "')\">" + childrenLi[i].innerText + "</a></td><td>"
            + childrenLi[i + 1].innerText + "</td><td>"
            + childrenLi[i + 2].innerText + "</td><td>"
            + childrenLi[i + 3].innerText + "</td><td>"
            + childrenLi[i + 4].innerText + "</td></tr>";
          i = i + 4;
        }
        tableHtml += "</table>";
        $('#content').html(tableHtml);
        loadCurrentProvince()
      }
    }
    xhr.send(null)
  });
  function selectProvince(text) {
    utools.dbStorage.setItem('province', text)
    loadCurrentProvince()
  }
  function loadCurrentProvince() {
    var childrenLi = $('td')
    var province = utools.dbStorage.getItem('province')
    if (province == null) {
      province = '北京'
    }
    for (var i = 0; i < childrenLi.length; i++) {
      if (childrenLi[i].innerText == province) {
        var henanText = childrenLi[i].innerText + '油价: '
        henanText += '92号汽油 <i>' + childrenLi[i + 1].innerText + '</i> 元/升;'
        henanText += '95号汽油 <i>' + childrenLi[i + 2].innerText + '</i> 元/升;'
        henanText += '98号汽油 <i>' + childrenLi[i + 3].innerText + '</i> 元/升;'
        henanText += '0号柴油 <i>' + childrenLi[i + 4].innerText + '</i> 元/升;'
        $('#title').html(henanText)
      }
    }
  }
</script>

</html>